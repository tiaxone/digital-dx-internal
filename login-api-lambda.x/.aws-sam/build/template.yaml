AWSTemplateFormatVersion: '2010-09-09'
Transform: AWS::Serverless-2016-10-31
Description: 'login-api-lambda.x

  Sample SAM Template for login-api-lambda.x

  '
Globals:
  Function:
    Timeout: 3
Resources:
  LoginApi:
    Type: AWS::Serverless::Api
    Properties:
      StageName: Prod
      Cors:
        AllowMethods: '''OPTIONS,POST,GET,PUT,DELETE'''
        AllowHeaders: '''content-type,X-Amz-Date,X-Amz-Security-Token,Authorization,X-Api-Key,X-Requested-With,Accept,Access-Control-Allow-Methods,Access-Control-Allow-Origin,Access-Control-Allow-Headers'''''
        AllowOrigin: '''*'''
      Auth:
        ApiKeyRequired: true
  LoginFunction:
    Type: AWS::Serverless::Function
    Properties:
      CodeUri: LoginFunction
      Handler: index.handler
      Runtime: nodejs16.x
      FunctionName: loginAPI
      Role: arn:aws:iam::388902109834:role/AuthLambdaRole
      Environment:
        Variables:
          SECRET: authSecret
      Architectures:
      - x86_64
      Events:
        HealthCheck:
          Type: Api
          Properties:
            RestApiId:
              Ref: LoginApi
            Path: /health
            Method: get
        Register:
          Type: Api
          Properties:
            RestApiId:
              Ref: LoginApi
            Path: /register
            Method: post
        Verify:
          Type: Api
          Properties:
            RestApiId:
              Ref: LoginApi
            Path: /verify
            Method: post
        Login:
          Type: Api
          Properties:
            RestApiId:
              Ref: LoginApi
            Path: /login
            Method: post
    Metadata:
      SamResourceId: LoginFunction
